import:
    - 'components/nucleotide_exchange.yaml'
    - 'components/pi_release_in_solution.yaml'

experiments:
    fujiwara_2002:
        parameters:
            simulation_duration: 20000
#            simulation_duration: 7500
#            simulation_duration: 6500
#            simulation_duration: 5400 # 90 minutes
            initial_atp_concentration: 0.3
            sample_period: 5


        simulation:
            filaments:
                filament_factory:
                    class_name: SingleStateFixedLengthFromConcentrations
                    variable_arguments:
                        number: number_of_filaments
                        concentration: seed_concentration
                        filament_tip_concentration: filament_tip_concentration
                    fixed_arguments:
                        state: ADP


            concentrations:
                ATP:
                    class_name: FixedReagent
                    variable_arguments:
                        sample_period: sample_period
                        initial_concentration: initial_atp_concentration
                        filament_tip_concentration: filament_tip_concentration
                        number: number_of_filaments


                ADPPi:
                    class_name: FixedReagent
                    variable_arguments:
                        sample_period: sample_period
                        filament_tip_concentration: filament_tip_concentration
                        number: number_of_filaments
                    fixed_arguments:
                        initial_concentration: 0

                ADP:
                    class_name: FixedReagent
                    variable_arguments:
                        sample_period: sample_period
                        filament_tip_concentration: filament_tip_concentration
                        number: number_of_filaments
                    fixed_arguments:
                        initial_concentration: 0

                Pi:
                    class_name: FixedReagent
                    variable_arguments:
                        sample_period: sample_period
                        filament_tip_concentration: filament_tip_concentration
                        number: number_of_filaments
                    fixed_arguments:
                        initial_concentration: 0

                TAG:
                    class_name: FixedReagent
                    variable_arguments:
                        sample_period: sample_period
                        filament_tip_concentration: filament_tip_concentration
                        number: number_of_filaments
                    fixed_arguments:
                        initial_concentration: 0

            end_conditions:
                duration:
                    class_name: Duration
                    variable_arguments:
                        duration: simulation_duration

            measurements:
                length:
                    class_name: Length
                    variable_arguments:
                        sample_period: sample_period

                tip_state:
                    class_name: TipState
                    variable_arguments:
                        sample_period: sample_period
                    fixed_arguments:
                        ATP: 0
                        ADPPi: 1
                        ADP: 2

#                atp_mean:
#                    class_name: StateDistributionMean
#                    fixed_arguments:
#                        state: ATP
#                    variable_arguments:
#                        sample_period: sample_period
#
#                atp_std:
#                    class_name: StateDistributionSTD
#                    fixed_arguments:
#                        state: ATP
#                    variable_arguments:
#                        sample_period: sample_period
#
#                adppi_mean:
#                    class_name: StateDistributionMean
#                    fixed_arguments:
#                        state: ADPPi
#                    variable_arguments:
#                        sample_period: sample_period
#
#                adppi_std:
#                    class_name: StateDistributionSTD
#                    fixed_arguments:
#                        state: ADPPi
#                    variable_arguments:
#                        sample_period: sample_period

#                adp_mean:
#                    class_name: StateDistributionMean
#                    fixed_arguments:
#                        state: ADP
#                    variable_arguments:
#                        sample_period: sample_period
#
#                adp_std:
#                    class_name: StateDistributionSTD
#                    fixed_arguments:
#                        state: ADP
#                    variable_arguments:
#                        sample_period: sample_period

                adppi_count:
                    class_name: StateCount
                    fixed_arguments:
                        state: ADPPi
                    variable_arguments:
                        sample_period: sample_period


        analyses:
            length:
                class_name: StandardErrorMean
                variable_arguments:
                    sample_period: sample_period
                    stop_time:     simulation_duration
                fixed_arguments:
                    interpolation_method: linear #previous_value
                    measurement_name: length
                    measurement_type: filament

#            atp_mean:
#                class_name: StandardErrorMean
#                variable_arguments:
#                    sample_period: sample_period
#                    stop_time:     simulation_duration
#                fixed_arguments:
#                    interpolation_method: linear #previous_value
#                    measurement_name: atp_mean
#                    measurement_type: filament
#
#            atp_std:
#                class_name: StandardErrorMean
#                variable_arguments:
#                    sample_period: sample_period
#                    stop_time:     simulation_duration
#                fixed_arguments:
#                    interpolation_method: linear #previous_value
#                    measurement_name: atp_std
#                    measurement_type: filament
#
#            adppi_mean:
#                class_name: StandardErrorMean
#                variable_arguments:
#                    sample_period: sample_period
#                    stop_time:     simulation_duration
#                fixed_arguments:
#                    interpolation_method: linear #previous_value
#                    measurement_name: adppi_mean
#                    measurement_type: filament
#
#            adppi_std:
#                class_name: StandardErrorMean
#                variable_arguments:
#                    sample_period: sample_period
#                    stop_time:     simulation_duration
#                fixed_arguments:
#                    interpolation_method: linear #previous_value
#                    measurement_name: adppi_std
#                    measurement_type: filament

#            adp_mean:
#                class_name: StandardErrorMean
#                variable_arguments:
#                    sample_period: sample_period
#                    stop_time:     simulation_duration
#                fixed_arguments:
#                    interpolation_method: linear #previous_value
#                    measurement_name: adp_mean
#                    measurement_type: filament
#
#            adp_std:
#                class_name: StandardErrorMean
#                variable_arguments:
#                    sample_period: sample_period
#                    stop_time:     simulation_duration
#                fixed_arguments:
#                    interpolation_method: linear #previous_value
#                    measurement_name: adp_std
#                    measurement_type: filament

            adppi_count:
                class_name: StandardErrorMean
                variable_arguments:
                    sample_period: sample_period
                    stop_time:     simulation_duration
                fixed_arguments:
                    interpolation_method: linear #previous_value
                    measurement_name: adppi_count
                    measurement_type: filament

            ATP:
                class_name: StandardErrorMean
                variable_arguments:
                    sample_period: sample_period
                    stop_time:     simulation_duration
                fixed_arguments:
                    interpolation_method: linear #previous_value
                    measurement_name: ATP
                    measurement_type: concentration

            ADPPi:
                class_name: StandardErrorMean
                variable_arguments:
                    sample_period: sample_period
                    stop_time:     simulation_duration
                fixed_arguments:
                    interpolation_method: linear #previous_value
                    measurement_name: ADPPi
                    measurement_type: concentration

            ADP:
                class_name: StandardErrorMean
                variable_arguments:
                    sample_period: sample_period
                    stop_time:     simulation_duration
                fixed_arguments:
                    interpolation_method: linear #previous_value
                    measurement_name: ADP
                    measurement_type: concentration

            Pi:
                class_name: StandardErrorMean
                variable_arguments:
                    sample_period: sample_period
                    stop_time:     simulation_duration
                fixed_arguments:
                    interpolation_method: linear #previous_value
                    measurement_name: Pi
                    measurement_type: concentration

            TAG:
                class_name: StandardErrorMean
                variable_arguments:
                    sample_period: sample_period
                    stop_time:     simulation_duration
                fixed_arguments:
                    interpolation_method: linear #previous_value
                    measurement_name: TAG
                    measurement_type: concentration

            final_tip_fluctuations:
                class_name: FluctuationVariances
                fixed_arguments:
                    interpolation_method: linear
                    start_time:    15000
                    tau_max: 1000
                variable_arguments:
                    stop_time:     simulation_duration
                    sample_period: sample_period
                    tau_min: sample_period

            fujiwara_tip_fluctuations:
                class_name: FluctuationVariances
                fixed_arguments:
                    interpolation_method: linear
                    start_time:    3600
                    stop_time:     5400
                    tau_max: 1000
                variable_arguments:
                    sample_period: sample_period
                    tau_min: sample_period

            # Individual filament lengths & states
            filament_0_length:
                class_name: IndividualFilament
                fixed_arguments:
                    measurement_name: length
                    simulation_index: 0
                    filament_index:   0
                variable_arguments:
                    sample_period: sample_period

            filament_0_state:
                class_name: IndividualFilament
                fixed_arguments:
                    measurement_name: tip_state
                    simulation_index: 0
                    filament_index:   0
                variable_arguments:
                    sample_period: sample_period

            filament_1_length:
                class_name: IndividualFilament
                fixed_arguments:
                    measurement_name: length
                    simulation_index: 1
                    filament_index:   0
                variable_arguments:
                    sample_period: sample_period

            filament_1_state:
                class_name: IndividualFilament
                fixed_arguments:
                    measurement_name: tip_state
                    simulation_index: 1
                    filament_index:   0
                variable_arguments:
                    sample_period: sample_period

            filament_2_length:
                class_name: IndividualFilament
                fixed_arguments:
                    measurement_name: length
                    simulation_index: 2
                    filament_index:   0
                variable_arguments:
                    sample_period: sample_period

            filament_2_state:
                class_name: IndividualFilament
                fixed_arguments:
                    measurement_name: tip_state
                    simulation_index: 2
                    filament_index:   0
                variable_arguments:
                    sample_period: sample_period

        objectives:
            executors:
                elongation_rate:
                    class_name: ElongationRate
                    variable_arguments:
                        sample_period: sample_period

                final_diffusion_coefficient:
                    class_name: DiffusionCoefficient
                    fixed_arguments:
                        analysis_name: final_tip_fluctuations

                fujiwara_diffusion_coefficient:
                    class_name: DiffusionCoefficient
                    fixed_arguments:
                        analysis_name: fujiwara_tip_fluctuations

#                fujiwara_diffusion_fit:
#                    class_name: DiffusionCoefficientFit
#                    variable_arguments:
#                        expected_value: expected_diffusion_coefficient
#                    fixed_arguments:
#                        analysis_name: fujiwara_tip_fluctuations
#                        residual_type: naked_chi_squared
