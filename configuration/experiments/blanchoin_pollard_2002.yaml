simulation:
    filaments:
        class_name: SingleStateFixedLengthFromConcentrations
        parameters:
            number: number_of_filaments
            concentration: seed_concentration
            filament_tip_concentration: filament_tip_concentration
        fixed_parameters:
            state: ADP

    concentrations:
        pyrene_ATP:
            class_name: FixedReagent
            parameters:
                initial_concentration: initial_pyrene_atp_concentration
                filament_tip_concentration: filament_tip_concentration
                number: number_of_filaments

        ATP:
            class_name: FixedReagent
            parameters:
                initial_concentration: initial_atp_concentration
                filament_tip_concentration: filament_tip_concentration
                number: number_of_filaments

        pyrene_ADPPi:
            class_name: FixedReagent
            parameters:
                filament_tip_concentration: filament_tip_concentration
                number: number_of_filaments
            fixed_parameters:
                initial_concentration: 0

        ADPPi:
            class_name: FixedReagent
            parameters:
                filament_tip_concentration: filament_tip_concentration
                number: number_of_filaments
            fixed_parameters:
                initial_concentration: 0

        pyrene_ADP:
            class_name: FixedReagent
            parameters:
                filament_tip_concentration: filament_tip_concentration
                number: number_of_filaments
            fixed_parameters:
                initial_concentration: 0

        ADP:
            class_name: FixedReagent
            parameters:
                filament_tip_concentration: filament_tip_concentration
                number: number_of_filaments
            fixed_parameters:
                initial_concentration: 0


        Pi:
            class_name: FixedReagent
            parameters:
                filament_tip_concentration: filament_tip_concentration
                number: number_of_filaments
            fixed_parameters:
                initial_concentration: 0

    # XXX Assign labels to end conditions
    #       it would be nice to know which one causes exit.
    end_conditions:
        - class_name: Duration
          parameters:
              duration: simulation_duration

    measurements:
        length:
            class_name: Length

        pyrene_atp_count:
            class_name: StateCount
            fixed_parameters:
                state: pyrene_ATP

        atp_count:
            class_name: StateCount
            fixed_parameters:
                state: ATP

        total_atp_count:
            class_name: StateCountSum
            fixed_parameters:
                base_state: ATP
                prefix: pyrene_

        pyrene_adppi_count:
            class_name: StateCount
            fixed_parameters:
                state: pyrene_ADPPi

        adppi_count:
            class_name: StateCount
            fixed_parameters:
                state: ADPPi

        total_adppi_count:
            class_name: StateCountSum
            fixed_parameters:
                base_state: ADPPi
                prefix: pyrene_

        pyrene_adp_count:
            class_name: StateCount
            fixed_parameters:
                state: pyrene_ADP

        adp_count:
            class_name: StateCount
            fixed_parameters:
                state: ADP

        total_adp_count:
            class_name: StateCountSum
            fixed_parameters:
                base_state: ADP
                prefix: pyrene_

analysis:
    pyrene_atp_count:
        class_name: StandardErrorOfTheMean
            fixed_parameters:
                measurement: pyrene_atp_count

    pyrene_adppi_count:
        class_name: StandardErrorOfTheMean
            fixed_parameters:
                measurement: pyrene_adppi_count

    adppi_count:
        class_name: StandardErrorOfTheMean
            fixed_parameters:
                measurement: adppi_count

    pyrene_adp_count:
        class_name: StandardErrorOfTheMean
            fixed_parameters:
                measurement: pyrene_adp_count

objectives:
    pollard_adppi_fit:
        class_name: SimpleDataFit
        fixed_parameters:
            measurements: total_adppi_count
            data_file: 'pollard_2002/adppi_concentration.dat'
            residual_function: naked_chi_squared
            interpolate_simulations: True

    pollard_pyrene_fit:
        class_name: PyreneFit
        parameters:
            sample_period: sample_period
            duration:      simulation_duration

            atp_weight:   pyrene_atp_weight
            adppi_weight: pyrene_adppi_weight
            adp_weight:   pyrene_adp_weight

        fixed_parameters:
            data_file: 'pollard_2002/pyrene_fluorescence.dat'
            residual_function: naked_chi_squared
            interpolate_data: True
            atp_state:   pyrene_ATP
            adppi_state: pyrene_ADPPi
            adp_state:   pyrene_ADP

# XXX I should no longer need this duplicated dsl code.
#required_parameters:
#    # Simulation parameters
#
#    # Initial concentrations
#    - initial_atp_concentration
#    - initial_pyrene_atp_concentration
#    - seed_concentration
#
#    # End Conditions
#    - simulation_duration
#
#    # Misc
#    - sample_period
#    - number_of_filaments
#    - filament_tip_concentration
#
#    # Objective parameters
#    - pyrene_atp_weight
#    - pyrene_adppi_weight
#    - pyrene_adp_weight
